# 页面性能优化
1. 资源压缩与合并，减少 http 请求次数
2. 非核心代码异步加载
3. 利用浏览器的缓存
4. 使用 CDN
5. 预解析 DNS
---
### 一、资源压缩与合并
1. 减少HTTP请求数
   - 合并JS文件和CSS文件。
   - 合并框架图片及相对变动较少的图片或成一张，通过CSS背景切割来完成渲染。
   - 合理使用本地Cache来缓存JS/CSS/IMAGE。
2. 减小被请求文件的大小，减少请求数据占用的网络带宽。
   - 压缩JS体积：删除JS中空白换行、注释、混淆，把长变量换成短变量。
   - 压缩CSS体积：删除CSS注释、写法尽量用简写。
3. 把 js 文件移到 HTML 文件末尾，css 文件移到顶端。
   - 因为JavaScript在处理的过程中会阻塞后面的页面显示，并且也会使HTML请求被阻止。
   - CSS 放到最顶部，浏览器能够有针对性的对 HTML 页面从顶到下进行解析和渲染。 

---
### 二、非核心代码异步加载
[异步加载](异步加载.md)
---
### 三、利用浏览器的缓存
[浏览器的缓存机制](浏览器的缓存机制.md)
---
### 四、使用 CDN
1. 为什么要使用 CDN ？
   - 由于利用浏览器的缓存始终只是提升了二次访问的速度，对于首次访问的加速，我们需要从网络层面进行优化。
2. 什么是 CDN ？
   - $\color{#6cf}{CDN}$（Content Delivery Network,内容分发网络）。通过将静态资源（例如 JavaScript、css、图片等）缓存到离用户很近的相同网络运营商的 CDN 节点上，不但能提升用户的访问速度，还能节省服务器的带宽消耗。
3. 为什么 CDN 能够做到加速？
  - 这是因为 CDN 服务商在全国各省份部署计算节点， CDN 加速将网站的内容缓存在网络边缘，不同地区的用户就会访问到离自己最近的相同网络路线上的 CDN 节点，当请求达到 CDN 节点后，节点判断自己的内容缓存是否有效。
  - 如果有效，则立即响应缓存内容给用户，从而加快响应速度。
  - 如果 CDN 节点的缓存已经失效，它会根据服务配置去我们的内容源服务器获取罪行的资源响应给用户，并将内容缓存下来给后续访问的用户。
  - 因此，一个地区只用有一个用户先加载了资源，在 CDN 节点上建立了缓存，该地区的其他后续用户就能因此而受益。
---
### 五、预解析 DNS
通过 DNS 预解析来告诉浏览器未来我们可能从某个特定的 URL 获取资源，当浏览器真正使用到该域中的某个资源时就可以尽快地完成 DNS 解析。例如，我们将来可从 example.com 获取图片或音频资源，那么可以在文档顶部的 标签中加入以下内容
```html
<link rel="dns-prefetch" herf="//example.com">
```
当我们从该 URL 请求一个资源时，就不再需要等待 DNS 的解析过程。该技术对使用第三方资源特别有用。通过简单的一行代码就可以告知那些兼容的浏览器进行 DNS 预解析，这意味着当浏览器真正请求该域中的某个资源时，DNS 的解析就已经完成了,从而节省了宝贵的时间。

！！！注意：
1. 浏览器会对a标签的href自动启用DNS Prefetching，所以a标签里包含的域名不需要在head中手动设置link。
2. 但是在HTTPS下不起作用，需要meta来强制开启功能。
3. 这个限制的原因是防止窃听者根据DNS Prefetching推断显示在HTTPS页面中超链接的主机名。
4. 这句话作用是强制打开a标签域名解析:
```html
<meta http-equiv="x-dns-prefetch-control" content="on">
```